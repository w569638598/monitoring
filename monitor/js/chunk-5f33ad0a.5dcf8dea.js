(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5f33ad0a"],{"047b":function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACIAAAAlCAYAAAAnQjt6AAAC3klEQVRYhe2Yz0sVURTHP++p8UotCoN+IW6yH7SJzERKMkqCoqggIohKMWphixDqDyiItHUQLtoU7gsixMjoF7YqKMWKLNCgH4SgaeLz22Lu8K63mZfXh7R5Xxjmnh9z5sw5d86cM5CHA0nNkj5LOiOJmKNT0ntJq7PouMdiSa8lvZJUHKNTL+mTpHYkPVcGJyOUiy35OQ9Haq3r6iPkdZZ8IgmcBkZMgG4BTU7QksCYWac9gj3t2LCxF+ix6H1JoB+oBkYNswM4G2N0ao6O2OtdwH2LbgC6Q08HgBpLeAM4atZpIOHhQBQKzHkz0G3xDwFdANnyKkk1hj9i6EaPPVJt2VloNu+4xTtl67u5ewZsI5OCp8ARYCiHaKSBE8ALIGV4hwn2YwYxT1Mh6avl/VgOEUlbdn5L2hmlH0akBCi1jkHgODBu5ItyiEh4DwHngUcR96MQuA0cjDAwBBQ5vBIPB1IOnQAuAO38vfl7kTSs2aPBIzWVHnaVkLQE2A8UE18nCoAPwEOPiEBQEjYxs47YSAKTQE9Ckqft+YH7+v435B1xkXfERd4RF3lHXBSacxVBGY8rs0ngB/DO0/5KoDyL3QRB+X+LpDce36btHh+9cmX6mH/hSxL45fGEVR66Fcy+j5koBLYCdczsPb4TNLo3Hf4os8dEBO8ycAdY5fAfZwttlxW6KXNu8khN2CpOW3b6JJVG6Ue9NcuBj8BuQ18iGDfmijTQRjDErQd+EkR7JhzP1kgasp7gmOF/yyEiklQkaYNFTyoYXSIjUga8tPLXCnQCC8iteQaoBfqAA4YuIhhVtoQKoSMpgplmhaGvAdctmc/MG4Vw0rsLNFv8J0Bl6MhSoBdYa4RXgYuWssh03T6VOG5M7QBazDpFkIV1SLpn5e5KRK5LLHmLxx7ZYV23J0J+0pIPI6lVwUjRFmMwKemBpEFJGz0cKZM0IKlf0rIYnUYFP4k6PCI9v/gDnN/InUiuzkUAAAAASUVORK5CYII="},"073c":function(t,e,i){},"16db":function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"deviateDialog"}},[a("div",{staticClass:"selectBox"},[a("span",{staticClass:"fl-l"},[t._v("筛选：")]),a("el-date-picker",{staticClass:"fl-l",attrs:{type:"date",placeholder:"创建日期","value-format":"yyyy-MM-dd"},model:{value:t.sDate,callback:function(e){t.sDate=e},expression:"sDate"}}),a("el-select",{staticClass:"fl-l",staticStyle:{width:"180px"},attrs:{placeholder:"选择矿点"},model:{value:t.mine,callback:function(e){t.mine=e},expression:"mine"}},t._l(t.mineData,function(t,e){return a("el-option",{key:e,attrs:{label:t.label,value:t.value}})}),1),a("span",{staticClass:"fl-l searchBtn",on:{click:t.getMineList}},[t._v("查找")]),a("span",{staticClass:"fl-r",on:{click:t.addMine}},[t._v("+ 新增矿点围栏")])],1),a("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:t.tableData,"tooltip-effect":"dark",stripe:t.stripe,border:t.border},on:{"selection-change":t.handleSelectionChange}},[a("el-table-column",{attrs:{label:"序号",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.$index+1))]}}])}),a("el-table-column",{attrs:{prop:"mines",label:"矿点名称"}}),a("el-table-column",{attrs:{prop:"status",label:"状态"},scopedSlots:t._u([{key:"default",fn:function(e){return["开启"===e.row.status?a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"点击关闭",placement:"right-start"}},[a("span",{staticClass:"statusBtn close",on:{click:function(i){return t.editorStatus(e.row)}}},[t._v("已开启")])]):a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"点击开启",placement:"right-start"}},[a("span",{staticClass:"statusBtn start",on:{click:function(i){return t.editorStatus(e.row)}}},[t._v("已关闭")])])]}}])}),a("el-table-column",{attrs:{prop:"createDate",label:"创建时间"}}),a("el-table-column",{attrs:{label:"操作","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{staticClass:"editorBtn fc-g",on:{click:function(i){return t.editor(e.row,e.$index)}}},[t._v("修改")]),a("span",{staticClass:"deleteBtn fc-r",on:{click:function(i){return t.deleteFn(e.row)}}},[t._v("删除")])]}}])})],1),a("el-pagination",{staticStyle:{"margin-top":"20px"},attrs:{background:"",layout:"prev, pager, next","page-size":t.pageSize,"current-page":t.currentPage,total:t.total},on:{"current-change":t.getMineList}}),a("el-dialog",{staticClass:"deviateDialog",attrs:{visible:t.isShow,title:"新增围栏"},on:{"update:visible":function(e){t.isShow=e},close:t.dialogClose}},[a("div",{staticClass:"po-re"},[a("baidu-map",{staticClass:"map",style:{width:t.width,height:t.height},attrs:{center:t.mapPoint,zoom:t.zoom,"scroll-wheel-zoom":!0},on:{click:t.paintPolyline}},[t._l(t.markerPointArr,function(t,e){return a("bm-marker",{key:e,attrs:{position:t}})}),a("bm-polyline",{attrs:{path:t.polyline.paths}})],2),t.polyline.editing?a("span",{staticClass:"po-ab positionDiv",on:{click:function(e){t.mapPosition,t.toggle("polyline")}}},[t._v("结束")]):a("span",{staticClass:"po-ab positionDiv",on:{click:function(e){t.mapPosition,t.toggle("polyline")}}},[t._v("绘制")]),a("span",{staticClass:"po-ab backDiv",attrs:{title:"撤销"},on:{click:t.back}},[a("img",{attrs:{src:i("dfbe"),alt:""}})]),t.zoomState?a("span",{staticClass:"po-ab narrowDiv",on:{click:t.narrow}},[a("img",{attrs:{src:i("047b"),title:"缩放地图",alt:""}})]):a("span",{staticClass:"po-ab enlargeDiv",on:{click:t.enlarge}},[a("img",{attrs:{src:i("c833"),title:"缩放地图",alt:""}})]),a("span",{staticClass:"po-ab reset",on:{click:t.cleanMapOverlay}},[a("img",{attrs:{src:i("f491"),title:"删除围栏",alt:"",width:"30px;"}})]),a("span",{staticClass:"po-ab done",on:{click:t.commit}},[t._v("\n        提交\n      ")]),"add"===t.operationType?a("div",{staticClass:"mapAboveSearch po-ab"},[a("el-select",{staticClass:"fl-l",attrs:{placeholder:"选择矿点"},model:{value:t.mapMine,callback:function(e){t.mapMine=e},expression:"mapMine"}},t._l(t.mineData,function(t,e){return a("el-option",{key:e,attrs:{label:t.label,value:t.value}})}),1),a("el-input",{staticClass:"carNumber",attrs:{placeholder:"输入所选矿点经纬度，并用','分隔",clearable:""},on:{change:t.addrOrPoint},model:{value:t.addressOrPoint,callback:function(e){t.addressOrPoint=e},expression:"addressOrPoint"}})],1):t._e()],1)])],1)},n=[],s=(i("7f7f"),i("ac6a"),i("28a5"),i("1c46"),i("2f62")),o=(i("5118"),{data:function(){return{pageSize:10,currentPage:0,total:null,stripe:!0,border:!0,tableData:[],zoomState:!0,addressOrPoint:"",mineData:[{label:"请选择报警类型",value:0},{label:"路线偏离",value:9},{label:"停车超时",value:10},{label:"断电报警",value:2},{label:"温度过高",value:5},{label:"GPS故障",value:11}],markerPointArr:[],mine:"",mapMine:"",sDate:"",isShow:!1,mapPoint:{lat:39,lng:114},width:"100%",height:"778px",zoom:12,polyline:{editing:!1,paths:[]},operationType:"add",editorId:""}},mounted:function(){this.getMineList(),this.getMines()},methods:{addrOrPoint:function(){if(""!=this.addressOrPoint){var t=/^[\u4e00-\u9fa5]+$/;if(t.test(this.addressOrPoint))this.$alert("请输入经纬度");else if(this.addressOrPoint.indexOf(",")<0)this.$alert("经纬度用','号分隔");else{var e={lng:this.addressOrPoint.split(",")[0],lat:this.addressOrPoint.split(",")[1]};this.mapPoint=e,this.markerPointArr.push(e)}}},dialogClose:function(){this.polyline.editing=!1,this.polyline.paths=[],this.markerPointArr=[],this.mapMine=""},editorStatus:function(t){var e=this,i=this.qs.stringify({id:t.id,status:"开启"==t.status?0:1});this.ajax.post("/monitorApi/updateVenderMinesEnclosureStatus",i).then(function(t){200==t.data.errorCode&&e.$alert("修改成功").then(function(t){e.getMineList()})})},editor:function(t){this.operationType="editor",this.isShow=!0,this.polyline.paths=this.parsePath(t.enclosure),this.mapPoint=this.polyline.paths[0],this.mapMine=t.mines,this.editorId=t.id},deleteFn:function(t){var e=this,i=this.qs.stringify({id:t.id});this.ajax.post("/monitorApi/deleteVenderMinesEnclosure",i).then(function(t){200==t.data.errorCode&&e.$alert("删除成功").then(function(t){e.getMineList()})})},commit:function(){var t=this;if(0!=this.polyline.paths.length)if(this.polyline.editing)this.$alert("请先结束绘画");else{"add"==this.operationType&&(this.editorId="");var e="";this.polyline.paths.forEach(function(t,i){for(var a in t)"lng"!=a&&"lat"!=a||(e+="lng"==a?t[a]+"_":t[a]+",")}),e=e.substring(0,e.lastIndexOf(","));var i=this.qs.stringify({venderId:this._venderLoginId,venderName:this._globalVenderName,mines:this.mapMine,polygon:e,id:this.editorId});this.ajax.post("/monitorApi/addOrUpdateVenderMinesEnclosure",i).then(function(e){200==e.data.errorCode&&("add"==t.operationType?t.$alert("添加成功").then(function(e){t.getMineList(),t.isShow=!1}):t.$alert("修改成功").then(function(e){t.getMineList(),t.isShow=!1}))})}else this.$alert("请先绘画围栏")},getMines:function(){var t=this;console.log(this._globalVenderName);var e=this.qs.stringify({vendername:this._globalVenderName,status:1});this.mineData=[],this.ajax.post("/monitorApi/query_venderMineral",e).then(function(e){e.data.body.resultList.forEach(function(e,i){var a={};a.label=e.mineralName,a.value=e.mineralName,t.mineData.push(a)})})},cleanMapOverlay:function(){this.polyline.editing=!1,this.polyline.paths=[],this.markerPointArr=[]},toggle:function(t){""!=this.mapMine||"editor"==this.operationType?("editor"!=this.operationType||0==this.polyline.paths.length||this.polyline.editing)&&("add"!=this.operationType||0==this.polyline.paths.length||this.polyline.editing)?(this[t].editing=!this[t].editing,this[t].editing||(this.polyline.paths.push(this.polyline.paths[0]),this.markerPointArr=[])):this.$alert("请先删除围栏，再绘制"):this.$alert("请选择矿点")},paintPolyline:function(t){this.polyline.editing&&(this.markerPointArr.push(t.point),this.polyline.paths.push(t.point))},handleSelectionChange:function(){},addMine:function(){this.operationType="add",this.isShow=!0},mapPosition:function(){},back:function(){this.polyline.editing&&(this.polyline.paths.pop(),this.markerPointArr.pop())},enlarge:function(){this.zoom>=18?this.zoomState=!0:this.zoom+=2},narrow:function(){this.zoom<=2?this.zoomState=!1:this.zoom-=2},getMineList:function(t){var e=this,i=this.qs.stringify({venderId:this._venderLoginId,createDate:this.sDate,pagesNo:"number"==typeof t?t-1:0,mines:this.mine});this.ajax.post("/monitorApi/getVenderMinesEnclosureList",i).then(function(t){t.data.body.list.forEach(function(t,e){t.status=1==t.status?"开启":"关闭"}),e.tableData=t.data.body.list,e.total=t.data.body.allcount})},quickSort:function(t){if(t.length<=1)return t;for(var e=Math.floor((t.length-1)/2),i=t.splice(e,1)[0],a=[],n=[],s=0;s<t.length;s++)t[s]<i?a.push(t[s]):n.push(t[s]);return this.quickSort(a).concat([i],this.quickSort(n))},parsePath:function(t){var e=t.split(","),i=[];return e.forEach(function(t){var e={};e.lng=t.split("_")[0],e.lat=t.split("_")[1],i.push(e)}),i}},computed:Object(s["c"])({_venderLoginId:function(t){return t._venderLoginId},_globalVenderName:function(t){return t.globalVenderName}})}),l=o,r=(i("29ff"),i("324c"),i("8e28"),i("2877")),c=Object(r["a"])(l,a,n,!1,null,"129887d6",null);e["default"]=c.exports},"29ff":function(t,e,i){"use strict";var a=i("073c"),n=i.n(a);n.a},"324c":function(t,e,i){"use strict";var a=i("d355"),n=i.n(a);n.a},"7f7f":function(t,e,i){var a=i("86cc").f,n=Function.prototype,s=/^\s*function ([^ (]*)/,o="name";o in n||i("9e1e")&&a(n,o,{configurable:!0,get:function(){try{return(""+this).match(s)[1]}catch(t){return""}}})},"8e28":function(t,e,i){"use strict";var a=i("c498"),n=i.n(a);n.a},c498:function(t,e,i){},c833:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACIAAAAlCAYAAAAnQjt6AAACkklEQVRYhe2Yu2sUURTGfzskijGJLC4RXyQRLTaC24jEYOWjstBOtBPsUgjaiE20sQix808QsRARGzEYGy0MpNCgJAiiIq5o1FXXJb6Sz+LOwOzNncdmR4KwH1x2Zu/57vn2nMPZMwMt1CMnaQpYDbwGZoCPwCzwHngFVIFak348oAvIA/3AVqDX/9wBrEPSJ8VjVBJNro2SFuKceMCjmF/yArjaZDQAPgCnY/arHvAyYnMc2A5MZyBkAbgCdAOfXQYe8DaCvAGTwyxxEFjl0uFhwu9CCXgODGYkYgy4CXQ69oSkPaGauS+pbNXRvKRik8U64qjPByFfs0jq9W/e+KR+B6kmaWCZIoYd5036e0EQ5pC0RtIlSX0h8pDv3I7MrgZFjDlE3LJsTkk6G3dI0SGmJqmUUsTFmEgsWUmHFSX9dBxYSOAdcXAeSsotVwgy6QhH5pykjgROn6S7Ic6NJD9pc71TUkXS+ZT2+L/+naSnaexzktL2gTxQabB3dAI/gD9Jho0I+afwVlpAgJYQGy0hNv5LIYcbtAfYDwylskzZJS/4rfp23P+FtfaGWvxgFi3+supRlpRP4ByyOItKGK6SQj0MnLG++wYsJvB+Wfc5YAooxqWmXdJ6h8oRLcX1lGnBT8e8xY+aZ3qQmS2+SDoWkw5JuteAiGANyD3phdM0LmkS1c+oBUlHMxIRrGJEZLbIjImS9AxJB0IGXx0irjUhIlglR2S+h67LHuahOEC3VUITwImEwkyDJ8BuzAN9gLWh67wHbI4g38E8mWWFGaAAzDn2fnvAtghiD7AvQyEAJ4F2546kaUddhHE8gxrpkjQR56QN05yqDo0VzEubTRlEogMz8z7GvKBps/Zd/lcGfwEoBNp0dZUqowAAAABJRU5ErkJggg=="},d355:function(t,e,i){},dfbe:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACIAAAAlCAYAAAAnQjt6AAACKUlEQVRYhcWYTUhVQRiGn3spAyOUCykGUQhuVCwoUUHBRRS0TKmNEASuNHRRi9oLEW0So40rXbVqlysxxYIiiAILWii0Ce7GNpcEo7fFOQfmXub83Tnn3BeGMz/MzMP5vplvZkqScNBpoOYyQKCyQ9+nwMssIFxAxoCHwL9WgvQD237+oFUgZ4B3wEm/3NYqkPdAZ1aTNwuyAwzmAZEGZB2YyAsiKcgyMJMnRBKQx8D9iPbDrEBORLTdA5Zi+l8CbgEXgR68feUA+Al8Bn4lJpFkSzfkrmNJa5JGQ+aoS7bK4QwgGrUUB1JSfdA7D+zHmKxZbQHXCAkLJsgpH+JcDhCBPgHDtgZz1XzIGQLgKrBmbZHUI2knB7+I0nWbj0zi2a9IVfGW/J+gogy8BRYLBukCFupqjN/zvGDz/JZUCuY3nXUBeFPgX+kAbgaFxn0E4AfQVxDMR2AkDKQL+A5UCoLpBqq26Fsl57NHgyYg/BjwDcN+EVoFpoA54AWwi7EkE2oaCI2+QVqM8fy7lj4VSVck3Za0LqkWM8aeQqJvY1qJGORBgv4VSdOStkPGOJRUTgKCpFcOIGYal/TVMs5A0sPzHeBLStvbtAsM4fmTqctprhOjpDn6RWseeGSUe9OAHAHjGYEAPAFe+/n2tDe9feqX9V9HmCn/e6GZS/gGMOvnOxxBhOd7fc0+S6wCm2QTk54BNVusSaN+vF3YRWeBGVeQrJTZ84az/gNMwKTQxhGanAAAAABJRU5ErkJggg=="},f491:function(t,e,i){t.exports=i.p+"img/reset.d90443c0.png"}}]);
//# sourceMappingURL=chunk-5f33ad0a.5dcf8dea.js.map